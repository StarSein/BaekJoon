# [Silver I] Сообщение - 22124 

[문제 링크](https://www.acmicpc.net/problem/22124) 

### 성능 요약

메모리: 18748 KB, 시간: 180 ms

### 분류

많은 조건 분기, 조합론, 수학, 문자열

### 제출 일자

2024년 6월 20일 06:10:40

### 문제 설명

<p>После многих лет безуспешных попыток ученые наконец-то смогли установить связь с разумной цивилизацией в космосе и выяснили, что алфавит инопланетян состоит всего из двух букв: <code>a</code> и <code>b</code>. Для приема сообщений был сконструирован специальный приемник, который выдает символы <code>a</code>, <code>b</code>, а также специальный символ <code>?</code>, если разобрать, какой символ был передан, не удалось.</p>

<p>Анализ показал, что инопланетяне передают все свои сообщения в виде двух одинаковых записанных подряд строк. Например, строки «<code>abab</code>» или «<code>aaaaaa</code>» могут быть сообщениями инопланетян, а «<code>abba</code>» или «<code>aaa</code>» — нет.</p>

<p>Прибор, сконструированный учеными, получив на вход потенциальное сообщение инопланетян, выдает все возможные способы прочитать строку без учета описанного выше свойства. Например, получив строку «<code>ab??</code>» прибор выдает строки «<code>abaa</code>», «<code>abab</code>», «<code>abba</code>» и «<code>abbb</code>», из них на самом деле только строка «<code>abab</code>» может быть сообщением от инопланетян, а остальные три не могут.</p>

<p>Для улучшения качества прибора ученые хотят узнать, сколько строк из тех, которые выведены прибором, не могут быть сообщением инопланетян. Помогите им это сделать.</p>

### 입력 

 <p>В первой строке содержится натуральное число <i>n</i> — число слов в сообщении, полученного учеными.</p>

<p>В каждой из следующих <i>n</i> строк содержится слово из сообщения, состоящее из символов <code>a</code>, <code>b</code> и <code>?</code>. Гарантируется, что все слова имеет четную длину, а также, что в каждом слове есть хотя бы один <code>?</code>. Суммарная длина всех слов не превышает 200000. Не гарантируется, что есть хотя бы один способ расшифровать каждое слово как сообщение инопланетян.</p>

### 출력 

 <p>Выведите <i>n</i> строк. В <i>i</i>-ой строке выведите число способов заменить <code>?</code> на буквы <code>a</code>, <code>b</code> так, чтобы <i>i</i>-е слово не было корректным сообщением инопланетян. Так как число способов может быть очень большим, необходимо выводить его по модулю 10<sup>9</sup>+7.</p>

